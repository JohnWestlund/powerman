# vpc.dev without on|off_all scripts

specification "vpc" {
	timeout 	1.0

	plug name { "0" "1" "2" "3" "4" "5" "6" "7" "8" 
		    "9" "10" "11" "12" "13" "14" "15" }

	script login {
		send "login\r\n"
		expect "[0-9]* OK"
	}
	script logout {
		send "logoff\r\n"
		expect "[0-9]* OK"
	}
	script status_all {
		send "spew 16\r\n"  # noise generator
		expect "[0-9]* OK"
		expect "[0-9]* vpc> "

		send "stat *\r\n"
		foreachplug {
			expect "plug ([0-9]+): (ON|OFF)"
			setplugstate $1 $2 on="ON" off="OFF"
		}
		expect "[0-9]* OK"
		expect "[0-9]* vpc> "
	}
	script on {
		send "on %s\r\n"
		expect "[0-9]* OK"
		expect "[0-9]* vpc> "
	}
	script off {
		send "off %s\r\n"
		expect "[0-9]* OK"
		expect "[0-9]* vpc> "
	}
}


device "test0" "vpc" "./vpcd |&"
node "t[0-15]" "test0"
