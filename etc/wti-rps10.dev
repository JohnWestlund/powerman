#
# wti-rps10.dev,v 1.6 2003/01/17 23:50:34 garlick Exp
# /chaos/cvs/powerman/etc/wti-rps10.dev,v
#
# Master configured for 9600 baud:
# if 9600 - wait 0.5 sec before sending next command
# if 2400 - wait 1.5 sec before sending next command
# Format of commands is ^X^X^B^X^X^B^X^XPC\r
#   where P is port number (0-9) and C is command (0,1,T,?)
#
# N.B. The 0.5 sec delays mentioned in the documentation don't seem to be 
# needed on my setup...
#
specification  {
	name 		"wti-rps10"
	type 		"serial"
	offstring 	"Off"
	onstring  	"On"
	maxplugcount	10
	timeout 	5 

	script login {
		delay 2
	}
# Do not define STATUS_ALL_SCRIPT because there may not be all 10
# boxes in a chain, and any missing ones will not respond, causing
# expect to time out
	script status {
		send "\030\030\002\030\030\002\030\030%s?\r"
		expect "Plug ([0-9]) (On|Off)"
		setstatus $1 $2
		expect "Complete"
		#delay 0.5
	}
	script on {
		send "\030\030\002\030\030\002\030\030%s1\r"
		expect "Plug [0-9] On"
		expect "Complete"
		#delay 0.5
	}
	script off {
		send "\030\030\002\030\030\002\030\030%s0\r"
		expect "Plug [0-9] Off"
		expect "Complete"
		#delay 0.5
	}
# The T command is dip switch configurable for 5 or 10 second delay
	script cycle {
		send "\030\030\002\030\030\002\030\030%s0\r"
		expect "Plug [0-9] Off"
		expect "Complete"
		delay 2.0
		send "\030\030\002\030\030\002\030\030%s1\r"
		expect "Plug [0-9] On"
		expect "Complete"
		#delay 0.5
	}
	plug name "0"
	plug name "1"
	plug name "2"
	plug name "3"
	plug name "4"
	plug name "5"
	plug name "6"
	plug name "7"
	plug name "8"
	plug name "9"
}
