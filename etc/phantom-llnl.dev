#
# $Id$
# $Source$
#
# Phantom 3.0.4b
# This version includes an LLNL-requested enhancement for P0 and P1 commands.
#
specification  "phantom-llnl" {
	timeout 	20.0

	plug name { "1" }

	script login {
		send "\036\035"	# enter "shell mode"
		expect "ok\r"
	}
	script status {
		send "P?\r\n"
		expect "(0|1)\r"
		setplugstate "1" $1 on="1" off="0"
	}
	script on {
		send "P1\r\n"
		expect "ok\r"
	}		
	script off {
		send "P0\r\n"
		expect "ok\r"
	}		
	script cycle {
		send "P0\r\n"
		expect "ok\r"
		delay 2
		send "P1\r\n"
		expect "ok\r"
	}
	script beacon_on {
		send "L1\r\n"	# LED on
		expect "ok\r"
		send "B1\r\n"	# blink LED
		expect "ok\r"
	}
	script beacon_off {
		send "L0\r\n"	# LED off
		expect "ok\r"
		send "B0\r\n"	# unblink LED
		expect "ok\r"
	}
# XXX phantom user's manual for v3.0.4 says 0=on, 1=off (opposite seems true)
	script status_beacon {
		send "L?\r\n"	# get LED status 1=on, 0=off, B=blink
		expect "(0|1|B)" 
		setplugstate "1" $1 on="(B|1)" off="0"
	}
	script status_temp {
		send "T0\r\n"	# get temp probe 0 (there is also a 1- unused)
		expect "([0-9]+)\r" # value is 8-bit Celcius  
		setplugstate "1" $1
	}
}
