#
# phantom4.dev,v 1.1 2003/09/27 02:51:10 garlick Exp
# /chaos/cvs/powerman/etc/phantom4.dev,v
#
# Phantom 4.0
#
specification  "phantom4" {
#	timeout 	5.0
	timeout 	15.0

	plug name { "1" }

	script login {
		send "\036\035"	# enter "shell mode"
		expect "ok\r"
#		send "I0"	# use reset pin to sense power status
#		expect "ok\r"
	}
	script status {
		send "P?\r\n"
		expect "(0|1)\r"
		setplugstate "1" $1 on="1" off="0"
	}
	script on {
		send "P1\r\n"
		expect "(ok|er)\r"
	}		
	script off {
		send "P0\r\n"
		expect "(ok|er)\r"
	}		
	script cycle {
		send "P0\r\n"
		expect "(ok|er)\r"
		delay 2
		send "P1\r\n"
		expect "(ok|er)\r"
	}
	script beacon_on {
		send "L1\r\n"	# LED on
		expect "ok\r"
		send "B1\r\n"	# blink LED
		expect "ok\r"
	}
	script beacon_off {
		send "L0\r\n"	# LED off
		expect "ok\r"
		send "B0\r\n"	# unblink LED
		expect "ok\r"
	}
	script status_beacon {
		send "L?\r\n"	# get LED status 1=on, 0=off, B=blink
		expect "(0|1|B)" 
		setplugstate "1" $1 on="(B|1)" off="0"
	}
	script status_temp {
		send "T\r\n"
		expect "([0-9]+)\r" # value is 3 digit celcius
		setplugstate "1" $1
	}
}
