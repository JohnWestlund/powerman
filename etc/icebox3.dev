#
# $Id$
# $Source$
#
# Linux Networx ICE Box firmware version 3.x
#
begin protocol specification
	specification name "icebox3"
	specification type "TCP"
	off string "0"
	on string  "1"
	all string "*"
	plug count 10
	device timeout 10
	begin LOGIN_SCRIPT
		expect "V3[^\n]*\r\n"
		send "auth icebox\r\n"
		expect "OK\r\n"
	end LOGIN_SCRIPT
	begin LOGOUT_SCRIPT
		send "q\r\n"
	end LOGOUT_SCRIPT
# This is the query for hard power status
	begin STATUS_SCRIPT
		send "ps *\r\n"
		expect "N1:([01]) N2:([01]) N3:([01]) N4:([01]) N5:([01]) N6:([01]) N7:([01]) N8:([01]) N9:([01]) N10:([01])[[:space:]]*\r\n"
			map $1 "1"
			map $2 "2"
			map $3 "3"
			map $4 "4"
			map $5 "5"
			map $6 "6"
			map $7 "7"
			map $8 "8"
			map $9 "9"
			map $10 "10"
	end STATUS_SCRIPT
# This is the query for soft power status
	begin STATUS_SOFT_SCRIPT
		send "ns *\r\n"
		expect "N1:([012]) N2:([012]) N3:([012]) N4:([012]) N5:([012]) N6:([012]) N7:([012]) N8:([012]) N9:([012]) N10:([012])[[:space:]]*\r\n"
			map $1 "1"
			map $2 "2"
			map $3 "3"
			map $4 "4"
			map $5 "5"
			map $6 "6"
			map $7 "7"
			map $8 "8"
			map $9 "9"
			map $10 "10"
	end STATUS_SOFT_SCRIPT
	begin ON_SCRIPT
		send "ph %s\r\n"
		expect "OK\r\n"
		delay 0.5
	end ON_SCRIPT
	begin OFF_SCRIPT
		send "pl %s\r\n"
		expect "OK\r\n"
		delay 0.5
	end OFF_SCRIPT
	begin CYCLE_SCRIPT
		send "pl %s\r\n"
		expect "OK\r\n"
		delay 0.5
		send "ph %s\r\n"
		expect "OK\r\n"
		delay 0.5
	end CYCLE_SCRIPT
	begin RESET_SCRIPT
		send "rp %s\r\n"
		expect "OK\r\n"
		delay 0.5
	end RESET_SCRIPT
	plug name "1"
	plug name "2"
	plug name "3"
	plug name "4"
	plug name "5"
	plug name "6"
	plug name "7"
	plug name "8"
	plug name "9"
	plug name "10"
end protocol specification
